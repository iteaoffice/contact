{% do headTitle().append(translate("txt-admin")) %}
{% do headTitle().append(translate("txt-view-selection-%s")|format(selectionServcie.selection)) %}
{% do headLink().appendStylesheet('//cdn.datatables.net/1.10.9/css/dataTables.bootstrap.min.css') %}
{% do headScript().appendFile('//cdn.datatables.net/1.10.9/js/jquery.dataTables.min.js', 'text/javascript') %}
{% do headScript().appendFile('//cdn.datatables.net/1.10.9/js/dataTables.bootstrap.min.js', 'text/javascript') %}


<h1>{{ selectionService.selection }}</h1>

{% if error %}
    {{ ztbalert().danger(error)|raw }}
{% endif %}

<!-- Nav tabs -->
<ul class="nav nav-tabs">
    <li class="active"><a href="#general" data-toggle="tab">{{ translate("txt-general") }}</a></li>
    <li><a href="#contacts" data-toggle="tab">{{ translate("txt-contacts") }}</a></li>
    <li><a href="#mailings" data-toggle="tab">{{ translate("txt-mailings") }}</a></li>
    <li><a href="#access" data-toggle="tab">{{ translate("txt-access") }}</a></li>
</ul>

<!-- Tab panes -->
<div class="tab-content">
    <div class="tab-pane active" id="general">
        <h2>{{ translate("txt-general") }}</h2>
        <dl class="dl-horizontal">
            <dt>{{ translate("txt-name") }}</dt>
            <dd>{{ selectionService.selection.selection }}</dd>
            <dt>{{ translate("txt-group-tag") }}</dt>
            <dd>{{ selectionService.selection.tag|default(translate("txt-not-provided")) }}</dd>
            <dt>{{ translate("txt-note") }}</dt>
            <dd>{{ selectionService.selection.note|default(translate("txt-not-provided")) }}</dd>
            <dt>{{ translate("txt-personal") }}</dt>
            <dd>{{ translate(selectionService.selection.getPersonal(true))|raw }}</dd>
            <dt>{{ translate("txt-date-created") }}</dt>
            <dd>{{ selectionService.selection.dateCreated|time_diff }}</dd>
            {% if selectionService.selection.dateDeleted %}
                <dt>{{ translate("txt-date-deleted") }}</dt>
                <dd><i class="fa fa-trash"></i> {{ selectionService.selection.dateDeleted|time_diff }}</dd>
            {% endif %}
            {% if selectionService.selection.contact %}
                <dt>{{ translate("txt-owner") }}</dt>
                <dd>{{ contactLink(selectionService.selection.contact,'view-admin','name') }}</dd>
            {% endif %}
            <dt>{{ translate("txt-amount-of-contacts") }}</dt>
            <dd>{{ selectionService.getAmountOfContacts() }}</dd>
            {% if selectionService.selection.mailingList|length > 0 %}
                <dt>{{ translate("txt-mailing-lists") }}</dt>
                {% for mailingList in selectionService.selection.mailingList %}
                    <dd>{{ mailingList.alias }}</dd>
                {% endfor %}
            {% endif %}
        </dl>

        {% if selectionService.isSql() %}
            <h2>{{ translate("txt-sql-query") }}</h2>
            <pre>{{ selectionService.selection.sql.query }}</pre>
        {% endif %}

        {{ selectionLink( selectionService.selection,'edit','button') }}


        {{ selectionLink( null ,'list','button') }}
    </div>
    <div class="tab-pane" id="contacts">
        <h2>{{ translate("txt-contacts") }}</h2>

        {% if contacts|length > 0 %}
            <table class="table table-striped table-condensed table-hover">
                <thead>
                <tr>
                    <th class="col-md-4">{{ translate("txt-contact") }}</th>
                    <th class="col-md-4">{{ translate("txt-email") }}</th>
                    <th class="col-md-4">{{ translate("txt-organisation") }}</th>
                </tr>
                </thead>
                <tbody>
                {% for contact in contacts %}
                    <tr>
                        <td>
                            <a href="{{ url('zfcadmin/contact-admin/view',{'id':contact['c_id']}) }}">{{ contact['c_firstName'] }} {{ contact['c_middleName'] }} {{ contact['c_lastName'] }}</a>
                        </td>
                        <td>{{ contact['c_email'] }}</td>
                        <td>{{ contact['o_organisation'] }}</td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        {% else %}
            {{ ztbalert().warning(translate("txt-no-contacts-in-this-selection"))|raw }}
        {% endif %}

        {{ selectionLink( selectionService.selection ,'edit-contacts','button') }}
    </div>
    <div class="tab-pane" id="mailings">
        <h2>{{ translate("txt-mailings") }}</h2>
        {% if selectionService.selection.mailing.count() > 0 %}
            <table class="table table-striped table-condensed">
                <thead>
                <tr>
                    <th class="col-md-4">{{ translate("txt-mailing") }}</th>
                    <th class="col-md-4">{{ translate("txt-subject") }}</th>
                    <th class="col-md-2">{{ translate("txt-owner") }}</th>
                    <th class="col-md-2">{{ translate("txt-date") }}</th>
                </tr>
                </thead>
                <tbody>
                {% for mailing in selectionService.selection.mailing %}
                    <tr>
                        <td>{{ mailingLink(mailing,'view','name') }}</td>
                        <td>{{ mailing.mailSubject }}</td>
                        <td>{{ contactLink(mailing.contact,'view-admin','name') }}</td>
                        <td>{{ mailing.dateCreated|time_diff }}</td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        {% else %}
            {{ ztbalert().info(translate("txt-no-mailing-send-with-this-selection"))|raw }}
        {% endif %}
    </div>
    <div class="tab-pane" id="access">
        <h2>{{ translate("txt-access") }}</h2>

        {% if selectionService.selection.access.count() > 0 %}
            <table class="table table-striped table-condensed">
                <thead>
                <tr>
                    <th class="col-md-4">{{ translate("txt-access") }}</th>
                </tr>
                </thead>
                <tbody>
                {% for access in  selectionService.selection.access %}
                    <tr>
                        <td>{{ accessLink(access,'view','name') }}</td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
        {% else %}
            {{ ztbalert().info(translate("txt-no-access-defined-for-this-selection"))|raw }}
        {% endif %}
    </div>
</div>



<script type="text/javascript">
    $(document).ready(function () {
        $('table').DataTable();
    });
</script>